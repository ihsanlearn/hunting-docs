# Simple Storage Service (S3) Bucket

Amazon S3 Bucket adalah penyimpanan di internet yand disediakan oleh Amazon (AWS). Ini digunakan untuk menyimpan dan mengakses berbagai file. Setiap penyimpanan atau "hard drive internet" ini disebut **Bucket** dan setiap bucket punya nama unik secara global (sama seperti domain)

***

### The Misconfiguration

Masalahnya pada hak akses (permission). Secara default sejak 2018, semua bucket baru bersifat private, namun seringkali developer mengubah menjadi public agar bisa menampilkan gambar. Mereka lupa bahwa public benar benar publc, bisa diakses oleh siapa saja di internet.

***

### 3 Level Missconfiguration

#### Public List

Sebagai attacker tidak bisa membaca file rahasia di dalamnya, tapi bisa melihat daftar nama file (listing) yang ada di bucket itu.

#### Public Read

Sebagai attacker tidak bisa melihat daftar filenya (tersembunyi), tetapi jika tahu nama filenya maka bisa mengunduhnya.

#### Public Write

Sebagai attacker tidak hanya bisa membaca, tapi juga mengupload file baru, menimpa file yang sudah ada, atau menghapus file. Seperti menimpa file js, phising, script xss etc.

***

### S3 Bucket Takeover

Skenarionya adalah perusahaan membuat subdomain yang menunjuk ke S3 Bucket. Suatu hari, mereka menghapus bucketnya tapi lupa menghapus record DNS subdomain itu. Sebagai attacker yang menemukan DNS yang menggantung ini dapad men-takeover dengan cara login ke akun AWS lalu membuat bucket baru dengan nama yang sama persis, dengan ini dapat mengontrol penuh subdomain milik korban.

***

### Policy "Any authenticated AWS User"

Bucket memang tidak diatur ke "Public", tapi diatur untuk mengizinkan akses dari "Authenticated AWS Users", yang mana ini artinya siapapun yang memiliki akun AWS dapat mengakses bucket itu.

***

### Tips

#### Bucket Name Discovery

Nama Bucket bisa ditemukan dari sumber Javascript, API Response, Permutasi/Penebakan.

***
